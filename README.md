# NYC Travel Time Map

![Animation](mapgif.gif)

## How does it work?

The main page is `index.html`, but most of the code is in `map.js`. `map.js` uses `d3.js` to render the map based on JSON data
generated by a couple Python scripts.

If you'd like to set this up yourself, you'll need to unzip the `google_transit.zip` file into this directory, then run
 `python3 generate_routes_json.py` and `python3 gtfs_json.py` to generate the required `subway.js` and `gtfs_json.js` files.
 These are required by `virtual_rider.js`, which implements Djiksta-like algorithm for simulating a rider's journey
 from a starting stop throughout the system. `virtual_rider.js` is invoked by `map.js` whenever a stop is clicked,
 and the results are used to shift the distance of each stop away from the clicked stop.

## Adapting to another city

If your city's transit system provides data in the GTFS format, you can _probably_ get this map working fairly well for it. Here's a rough set of steps, which may be incomplete:

1. Download and unzip the gtfs data, and place the folder (rename it `google_transit` if it's not called that already).

2. Use Python 3 to run `generate_routes_json.py` This generates a file called `subway.json`, which you'll need.

3. Use Python 3 to run `gtfs_json.py` â€” this generates a new copy of the `schedules/` folder and its contents.

Feel free to post an issue if you have any questions!

## Research and Notes
* Data Source
  * http://www.vbb.de/de/download/GTFS.zip
  * https://transitfeeds.com/p/verkehrsverbund-berlin-brandenburg/213
  * https://transitfeeds.com/p/verkehrsverbund-berlin-brandenburg/213/latest/routes?type=400
* Google Maps for Comparison
  * https://www.google.de/maps/@52.5545076,13.4263629,10.31z/data=!5m1!1e2
* GTFS
  * https://developers.google.com/transit/gtfs/reference/
  * https://sites.google.com/site/gtfschanges/proposals/route-type
  * https://developers.google.com/transit/gtfs/reference/extended-route-types
* Filter
  * https://gis.stackexchange.com/a/219398/111548
  * http://developer.onebusaway.org/modules/onebusaway-gtfs-modules/current-SNAPSHOT/onebusaway-gtfs-transformer-cli.html
  * `java -Xmx3G -jar .\onebusaway-gtfs-transformer-cli-1.3.4-20150503.062227-12.jar --transform=retain.txt 1190951.zip filtered.zip`
